<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.plot.ly/plotly-latest.min.js" type="text/javascript"></script>
</head>
<body>
<div id="graph" style="width: 600px; height: 400px;"></div>
<script type="text/javascript">const graphDiv=document.getElementById("graph");function getData({f:e,rMax:a,dx:t,dy:s,nCircularLines:r,nRadialLines:o}){const n=[],i=Math.ceil(2*a/t)+1,l=Math.ceil(2*a/s)+1,d={x:[],y:[],z:[]};for(let r=0;r<i;++r){const o=r*t-a;if(o>a)break;d.x.push(o);const i=[];for(let t=0;t<l;++t){const l=t*s-a;if(l>a)break;const c=e(o,l);n.push({x:o,y:l,z:c}),0===r&&d.y.push(l),i.push(c)}d.z.push(i)}const c=Math.PI/o,h=[];for(let t=0;t<o;++t){const s={x:[],y:[],z:[]},r=t*c;for(let t=-a;t<=a;t+=.05){const a=t*Math.cos(r),o=t*Math.sin(r);s.x.push(a),s.y.push(o),s.z.push(e(a,o))}h.push(s)}const u=a/r,m=[];for(let a=0;a<r;++a){const t={x:[],y:[],z:[]},s=u*a;for(let a=0;a<=2*Math.PI;a+=.05){const r=s*Math.cos(a),o=s*Math.sin(a);t.x.push(r),t.y.push(o),t.z.push(e(r,o))}m.push(t)}return{data:n,grid:d,radialLines:h,circularLines:m}}function getDataForTemp({temperature:e,lambda:a,rMax:t,dx:s,dy:r,nCircularLines:o,nRadialLines:n}){const i=e*e,l=getData({f:(e,t)=>{const s=e*e+t*t;return(1-i)*s+a*(s*s)},rMax:t,dx:s,dy:r,nCircularLines:o,nRadialLines:n});let d=Math.abs(l.data[0].y);for(const e of l.data){const a=Math.abs(e.y);a<d&&(d=a)}const c=l.data.filter(({y:e})=>e===d),h=l.grid,u=(i-1)/(2*a),m=Math.sqrt(u),g=Math.max(...c.filter(({x:e})=>Math.abs(e)>m).map(({z:e})=>e));for(let e=0;e<h.z.length;++e){const a=h.x[e],t=a*a,s=h.z[e];for(let e=0;e<s.length;++e){const r=h.y[e];(t+r*r>=u&&s[e]>g||a>0&&r>0)&&(s[e]=null)}}const p=l.radialLines,x=l.circularLines;for(const e of[p,x])for(const a of e)for(let e=0;e<a.x.length;++e){const t=a.x[e],s=a.y[e];t>0&&s>0&&(a.z[e]=null)}return{data2d:c,data3d:h,radialLines:p,circularLines:x}}function makePlot(){const e=[1,1.5,2,2.5,3,3.5,4],a=[],t=[];e.forEach((s,r)=>{const{data2d:o,data3d:n,radialLines:i,circularLines:l}=getDataForTemp({temperature:s,lambda:.5,rMax:5,dx:.03,dy:.03,nCircularLines:10,nRadialLines:12}),d=`t${s}`,c={visible:0===r,x:o.map(e=>e.x),y:o.map(e=>e.z),type:"line",showgrid:!1,showlegend:!1,xaxis:"x2",yaxis:"y2"},h={visible:0===r,...n,type:"surface",showscale:!1,scene:"scene1",colorscale:[[0,"rgb(0.6,0.6,0.6)"],[1,"rgb(0.9,0.7,0.7)"]],contours:{x:{highlight:!1},y:{highlight:!1},z:{show:!1}}};a.push(c),a.push(h);for(const e of[...i,...l])a.push({visible:0===r,type:"scatter3d",mode:"lines",...e,line:{color:"#ccc",width:2},showscale:!1,scene:"scene1"});const u=2+i.length+l.length,m=Array.from({length:e.length*u}).map(()=>!1),g=u*r;for(let e=0;e<u;++e)m[g+e]=!0;const p={label:d,method:"restyle",args:["visible",m]};t.push(p)}),console.log(t);const s={showlegend:!1,showgrid:!1,hovermode:!1,yaxis2:{anchor:"x2",domain:[0,1],showgrid:!1,visible:!1},xaxis2:{anchor:"y2",domain:[0,.5],showgrid:!1,visible:!1},scene1:{camera:{eye:{x:1,y:1,z:.3}},domain:{x:[.5,1],y:[0,1]},xaxis:{showgrid:!1,visible:!1,showspikes:!1},yaxis:{showgrid:!1,visible:!1,showspikes:!1},zaxis:{showgrid:!1,visible:!1,showspikes:!1},margin:{t:0,b:0,l:0,r:0},hovermode:!1},sliders:[{pad:{t:30},x:.05,len:.95,transition:{duration:500},steps:t}]};return Plotly.newPlot(graphDiv,a,s,{displayModeBar:!1}),{traces:a,layout:s}}const p=makePlot(),x=()=>Plotly.plot("graph",{data:[{x:[1,2,3],y:[2,1,3],line:{color:"red",simplify:!1}}],layout:{sliders:[{pad:{t:30},x:.05,len:.95,currentvalue:{xanchor:"right",prefix:"color: ",font:{color:"#888",size:20}},transition:{duration:500},steps:[{label:"red",method:"animate",args:[["red"],{mode:"immediate",frame:{redraw:!1,duration:500},transition:{duration:500}}]},{label:"green",method:"animate",args:[["green"],{mode:"immediate",frame:{redraw:!1,duration:500},transition:{duration:500}}]},{label:"blue",method:"animate",args:[["blue"],{mode:"immediate",frame:{redraw:!1,duration:500},transition:{duration:500}}]}]}]},frames:[{name:"red",data:[{y:[2,1,3],"line.color":"red"}]},{name:"green",data:[{y:[3,2,1],"line.color":"green"}]},{name:"blue",data:[{y:[1,3,2],"line.color":"blue"}]}]},{showSendToCloud:!0});</script></body>
</html>